<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
	<meta charset="UTF-8">
	<link rel="shortcut icon" href="favicon.ico">
	<link rel="stylesheet" href="css/iconfont.css">
	<link rel="stylesheet" href="css/global.css">
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/bootstrap-theme.min.css">
	<link rel="stylesheet" href="css/swiper.min.css">
	<link rel="stylesheet" href="css/styles.css">
	<script src="js/jquery.1.12.4.min.js" charset="UTF-8"></script>
	<script src="js/bootstrap.min.js" charset="UTF-8"></script>
	<script src="js/swiper.min.js" charset="UTF-8"></script>
	<script src="js/global.js" charset="UTF-8"></script>
    <link rel="stylesheet" href="js/layui/css/layui.css"  media="all">
    <script type="text/javascript" src="js/layui/layui.js"></script>
    <title>唯品会</title>
	<script>
        var ip="192.168.51.236"
        var pagenum;
		//读取url参数值
        function GetQueryString(name)
        {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) {
                return unescape(r[2]);
            }
            return null;
        };

        //首先初始化时间格式工具，可直接复制到js里面
        Date.prototype.Format = function (fmt){
            var o = {
                "M+": this.getMonth() + 1,  //月份
                "d+": this.getDate() ,  //日
                "h+": this.getHours() ,  //24小时制
                "m+": this.getMinutes(),  //分
                "s+": this.getSeconds(),  //秒
                "q+": Math.floor((this.getMonth()+3)/3),  //季度
                "S": this.getMilliseconds()  //毫秒
            };
            if(/(y+)/.test(fmt))
                fmt = fmt.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));
            for(var k in o)
                if(new RegExp("("+k+")").test(fmt))
                    fmt = fmt.replace(RegExp.$1,(RegExp.$1.length ==1) ? (o[k]):(("00"+o[k]).substr((""+o[k]).length)));
            return fmt;

        };

        //其次，对方法进行封装
        function formatTime(timeSecond){
            var d = new Date(timeSecond);//注意timeSecond是毫秒
            return d.Format("yyyy-MM-dd hh:mm:ss");
        }

		$(function a() {
                var out_trade_no=GetQueryString("out_trade_no");
                var trade_no=GetQueryString("trade_no");
                var total_amount=GetQueryString("total_amount");
                if (total_amount!=null||total_amount!=""){
                    $.ajax({
                        url: "http://"+ip+":7080/update",
                        type:"POST",
                        data:{"orderno":out_trade_no,"orderstate":3,"orderpaynumber":trade_no},
                        success: function (resut) {
                            console.log(resut)
                            // alert(resut)
                        }
                    })
                }
                $.ajax({
                    url:"http://192.168.51.252:8082/shopping/getname",
                    dataType: "text",
                    xhrFields: {
                        withCredentials: true
                    },
                    crossDomain: true,
                    success : function(result){
                        if(result != "400"){
                            var a =""+result
                            var tel1 = a.substr(0,3) + "****" + a.substr(7)
                            $(".c1").text(tel1)
                            $(".hh").removeAttr('href')
                            $(".hh").removeAttr('onclick')
                        }else{
                            location.replace("logins.html")
                        }
                    }
                });
                sel(1)
            }
        )
		function sel(pagenum) {
			$.ajax({
				url:"http://192.168.51.252:8082/orderpeo/selall",
				type:"post",
				data:{pagenum:pagenum},
				datatype:"json",
				xhrFields: {
                    withCredentials: true
                },
                crossDomain: true,
				success:function (result) {
					result=JSON.parse(result)
					console.log(result)
                    pageNum=list.pageNum
                    pageSize =list.pageSize;
                    total = list.total;
                    pagehelp(total, pageNum, pageSize)
					var lstr;
					for (i=0;i<10;i++) {
					    var orderId=result[i].orderId
						var orderMoney=result[i].orderMoney
						var orderNo=result[i].orderNo
						var orderState=result[i].orderState
						var orderTime= formatTime(result[i].orderTime)
                        var wphOrderShoping = result[i].wphOrderShoping
						console.log(wphOrderShoping[0])
                        var picture =wphOrderShoping[0].picture
                        var skuname =wphOrderShoping[0].skuname
                        var skumoney =wphOrderShoping[0].skumoney
                        var orderShopingNum =wphOrderShoping[0].orderShopingNum
                        var ordershopingmoney =wphOrderShoping[0].ordershopingmoney

                        var str='<tr class="order-item" ><td><label><a href="wphorderdetail.html?orderId='+orderId+'" class="num"> '+orderTime+'订单编号:' +orderNo+'</a>' +
                            '<div class="card"> <div class="img"><img  src="' + picture + '" alt="" class="cover"></div> <div class="name ep2">'+skuname+'</div> </div>' +
                            '</label> </td> <td>￥' + ordershopingmoney + '</td> <td>' + orderShopingNum + '</td> <td>￥' + orderMoney + '<br><span class="fz12 c6 text-nowrap">(含运费: ¥0.00)</span></td>'
						if (orderState==0){
						    orderState="未支付"
                            str1='<td class="state"> <a class="but c6">'+orderState+'</a> <a href="wphorderdetail.html?orderId='+orderId+'" class="but c9">订单详情</a> </td> <td class="order"> ' +
                            '<div class="del"><span class="glyphicon glyphicon-trash" aria-hidden="false" onclick=del('+orderId+')></span></div>' +
                            '<a href="http://'+ip+':7081/pay?WIDout_trade_no='+orderNo+'&WIDtotal_amount='+orderMoney+'&WIDsubject='+1+'&WIDbody='+1+' class="but but-primary">立即付款</a>' +
							' <a onclick=qx('+orderNo+')>取消订单</a><a onclick=del('+orderId+') class="but c3">删除订单</a></td></tr>'
							lstr=str+str1;
                            $("#bbbb").before(lstr)
						}else if (orderState==1){
                            orderState="已取消"
                            str='<td class="state"><a class="but c6">'+orderState+'</a><a href="logistics.html" class="but cr">查看物流</a>' +
                                '<a href="wphorderdetail.html?orderId='+orderId+'" class="but c9">订单详情</a></td><td class="order">' +
                                '<div class="del"><span class="glyphicon glyphicon-trash" aria-hidden="false" onclick=del('+orderId+')></span></div>' +
                                '<a onclick=del('+orderId+') class="but c3">删除订单</a></td></tr>'
                            lstr+=str+str1;
                        }else if (orderState==2){
                            orderState="待收货"
                            str1='<td class="state"><a class="but c6">'+orderState+'</a><a href="logistics.html" class="but cr">查看物流</a>' +
                                '<a href="wphorderdetail.html?orderId='+orderId+'" class="but c9">订单详情</a></td><td class="order">' +
                                '<div class="del"><span class="glyphicon glyphicon-trash" aria-hidden="false" onclick=del('+orderId+')></span></div>' +
                                '<a onclick=qrsh('+orderNo+') class="but but-primary">确认收货</a>' +
                                '<a onclick=sqtk('+orderNo+') class="but c3">退款/退货</a></td></tr>'
                            lstr=str+str1;
                            $("#dddd").before(lstr)
                        }else if (orderState==3){
                            orderState="待发货"
							str1='<td class="state"><a class="but c6">'+orderState+'</a>' +
								'<a href="wphorderdetail.html?orderId='+orderId+'" class="but c9">订单详情</a></td><td class="order">' +
								'<div class="del"><span class="glyphicon glyphicon-trash" aria-hidden="false" onclick=del('+orderId+')></span></div>' +
								'<a onclick=qrsh('+orderNo+') class="but but-primary">确认收货</a>' +
								'<a onclick=sqtk('+orderNo+') class="but c3">退款/退货</a></td></tr>'
                            lstr=str+str1;
                            $("#cccc").before(lstr)
                        }else if (orderState==4) {
                            orderState="待评价"
                            str1='<td class="state"> <a class="but c6">'+orderState+'</a>'+
                                '<a href="logistics.html" class="but cr">查看物流</a>' +
                                '<a href="wphorderdetail.html?orderId='+orderId+'" class="but c9">订单详情</a></td><td class="order">' +
                                '<div class="del"><span class="glyphicon glyphicon-trash" aria-hidden="false" onclick=del('+orderId+')></span></div>' +
                                '<a href="" class="but but-link">评价</a><a onclick=sqtk('+orderNo+') class="but c3">退款/退货</a></td></tr>'
                            lstr=str+str1;
                            $("#eeee").before(lstr)
						}else if (orderState==7) {
                            orderState="交易成功"
                            str1='<td class="state"> <a class="but c6">'+orderState+'</a>'+
                                '<a href="logistics.html" class="but cr">查看物流</a>' +
                                '<a href="wphorderdetail.html?orderId='+orderId+'" class="but c9">订单详情</a></td><td class="order">' +
                                '<div class="del"><span class="glyphicon glyphicon-trash" aria-hidden="false" onclick=del('+orderId+')></span></div>' +
                                '<a onclick=sqtk('+orderNo+') class="but c3">退款/退货</a></td></tr>'
                            lstr=str+str1;
						}
                        $("#aaaa").before(lstr)
                    }
                }
			})
        }

        // 取消订单
		function qx(orderno) {
			$.ajax({
                url: "http://"+ip+":7080/update",
                type:"POST",
                data:{"orderno":orderno,"orderstate":1,"orderpaynumber":""},
                success: function (resut) {
                    console.log(resut)
				}
			})
        }
        //删除订单
		function del(orderid){
            $.ajax({
                url: "http://"+ip+":7080/orderdel",
                type:"POST",
                data:{"orderid":orderid},
                success: function (resut) {
                    alert(resut)
                    location.reload()
				}
			})
		}
		//申请退款
		function sqtk(orderno){
            $.ajax({
                url: "http://"+ip+":7080/update",
                type:"POST",
                data:{"orderno":orderno,"orderstate":5,"orderpaynumber":""},
                success: function (resut) {
                	alert("退款申请成功")
                }
            })
		}
		//确认收货
		function qrsh(orderno){
            $.ajax({
                url: "http://"+ip+":7080/update",
                type:"POST",
                data:{"orderno":orderno,"orderstate":4,"orderpaynumber":""},
                success: function (resut) {
                    console.log(resut)
                }
            })
		}
        function pagehelp(total, pageNum, pageSize) {
            layui.use('laypage', function() {
                var laypage = layui.laypage;
                //分页完整功能
                laypage.render({
                    elem: 'demo7',
                    count: total, //数据总数，从服务端得到
                    limit: pageSize, //每页显示的条数。laypage将会借助 count 和 limit 计算出分页数。
                    curr: pageNum, //当前页号
                    limits:[10],
                    layout: ['count', 'prev', 'page','limit','refresh', 'next', 'skip'],
                    jump: function(obj, first) {
                        var num = obj.curr;
                        var size = obj.limit;
                        console.log(obj)
                        if(!first) { //首次不执行(点击的时候才执行)
                            $("#aaa").html("");
                            $("#bbb").html("");
                            $("#ccc").html("");
                            $("#ddd").html("");
                            $("#eee").html("");
                            sel(num); //执行查询分页函数(这个函数必须写在这里)
                        }
                    }
                });
            })
        }
	</script>

</head>
<body>
	<!-- 顶部tab -->
	<div class="tab-header">
		<div class="inner">
			<div class="pull-left">
				<div class="pull-left">嗨，欢迎<span class="c1"></span><span class="cr">来到唯品会</span></div>
				<a href="agent_level.html">网店代销</a>
				<a href="connectService.html">帮助中心</a>
			</div>
			<div class="pull-right">
				<a href="logins.html" class="hh"><span class="cr">登录</span></a>
				<a href="logins.html?p=register" class="hh">注册</a>
				<a href="wphshopcart.html">我的购物车</a>
				<a href="wphorder.html">我的订单</a>
				<a href="udai_integral.html">积分平台</a>
			</div>
		</div>
	</div>
	<!-- 顶部标题 -->
	<div class="bgf5 clearfix">
		<div class="top-user">
			<div class="inner">
				<a class="logo" href="index.html"><img src="images/logo.png" alt="唯品会" class="cover"></a>
				<div class="title">个人中心</div>
			</div>
		</div>
	</div>
	<div class="content clearfix bgf5">
		<section class="user-center inner clearfix">
			<div class="pull-left bgf">
				<a href="udai_welcome.html" class="title">唯品会欢迎页</a>
				<dl class="user-center__nav">
					<dt>帐户信息</dt>
					<a href="http://192.168.50.238:8083/udai_setting.html"><dd>个人资料</dd></a>
					<a href="udai_treasurer.html"><dd>资金管理</dd></a>
					<a href="udai_integral.html"><dd>积分平台</dd></a>
					<a href="udai_address.html"><dd>收货地址</dd></a>
					<a href="tickets.html"><dd>我的优惠券</dd></a>
					<a href="udai_paypwd_modify.html"><dd>修改支付密码</dd></a>
					<a href="logins.html?p=resetpwd"><dd>修改登录密码</dd></a>
				</dl>
				<dl class="user-center__nav">
					<dt>订单中心</dt>
					<a href="wphorder.html"><dd class="active">我的订单</dd></a>
					<a href="udai_collection.html"><dd>我的收藏</dd></a>
					<a href="udai_refund.html"><dd>退款/退货</dd></a>
				</dl>
				<dl class="user-center__nav">
					<dt>服务中心</dt>
					<a href="logistics.html"><dd>物流查询</dd></a>
					<a href=""><dd>数据自助下载</dd></a>
					<a href="temp_article/udai_article1.html"><dd>售后服务</dd></a>
					<a href="temp_article/udai_article2.html"><dd>配送服务</dd></a>
					<a href="temp_article/udai_article3.html"><dd>用户协议</dd></a>
					<a href="temp_article/udai_article4.html"><dd>常见问题</dd></a>
				</dl>
				<dl class="user-center__nav">
					<dt>新手上路</dt>
					<a href="temp_article/udai_article5.html"><dd>如何成为代理商</dd></a>
					<a href="temp_article/udai_article6.html"><dd>代销商上架教程</dd></a>
					<a href="temp_article/udai_article7.html"><dd>分销商常见问题</dd></a>
					<a href="temp_article/udai_article8.html"><dd>付款账户</dd></a>
				</dl>
				<dl class="user-center__nav">
					<dt>U袋网</dt>
					<a href="temp_article/udai_article10.html"><dd>企业简介</dd></a>
					<a href="temp_article/udai_article11.html"><dd>加入唯品会</dd></a>
					<a href="temp_article/udai_article12.html"><dd>隐私说明</dd></a>
				</dl>
			</div>
			<div class="pull-right">
				<div class="user-content__box clearfix bgf">
					<div class="title">订单中心-我的订单</div>
					<div class="order-list__box bgf">
						<div class="order-panel">
							<ul class="nav user-nav__title" role="tablist">
								<li role="presentation" class="nav-item active"><a href="#all" aria-controls="all" role="tab" data-toggle="tab">所有订单</a></li>
								<li role="presentation" class="nav-item "><a href="#pay" aria-controls="pay" role="tab" data-toggle="tab">待付款 <span class="cr"></span></a></li>
								<li role="presentation" class="nav-item "><a href="#emit" aria-controls="emit" role="tab" data-toggle="tab">待发货 <span class="cr"></span></a></li>
								<li role="presentation" class="nav-item "><a href="#take" aria-controls="take" role="tab" data-toggle="tab">待收货 <span class="cr"></span></a></li>
								<li role="presentation" class="nav-item "><a href="#eval" aria-controls="eval" role="tab" data-toggle="tab">待评价 <span class="cr"></span></a></li>
							</ul>

							<div class="tab-content">
								<div role="tabpanel" class="tab-pane fade in active" id="all">
									<table class="table text-center ">
										<tr>
											<th width="380">商品信息</th>
											<th width="85">单价</th>
											<th width="85">数量</th>
											<th width="120">实付款</th>
											<th width="120">交易状态</th>
											<th width="120">交易操作</th>
										</tr>
                                        <tbody id='aaa'>
                                        <tr id="aaaa"></tr>
                                        </tbody>
									</table>
                                    <div id="demo7"></div>
								</div>
								<div role="tabpanel" class="tab-pane fade" id="pay">
									<table class="table text-center">
										<tr>
											<th width="380">商品信息</th>
											<th width="85">单价</th>
											<th width="85">数量</th>
											<th width="120">实付款</th>
											<th width="120">交易状态</th>
											<th width="120">交易操作</th>
										</tr>
                                        <tbody id='bbb'>
                                        <tr id="bbbb"></tr>
                                        </tbody>

									</table>

								</div>
								<div role="tabpanel" class="tab-pane fade" id="emit">
									<table class="table text-center">
										<tr>
											<th width="380">商品信息</th>
											<th width="85">单价</th>
											<th width="85">数量</th>
											<th width="120">实付款</th>
											<th width="120">交易状态</th>
											<th width="120">交易操作</th>
										</tr>
                                        <tbody id='ccc'>
                                        <tr id="cccc"></tr>
                                        </tbody>
									</table>
								</div>
								<div role="tabpanel" class="tab-pane fade" id="take">
									<table class="table text-center">
										<tr>
											<th width="380">商品信息</th>
											<th width="85">单价</th>
											<th width="85">数量</th>
											<th width="120">实付款</th>
											<th width="120">交易状态</th>
											<th width="120">交易操作</th>
										</tr>
                                        <tbody id='ddd'>
                                        <tr id="dddd"></tr>
                                        </tbody>
									</table>
								</div>
								<div role="tabpanel" class="tab-pane fade" id="eval">
									<table class="table text-center">
										<tr>
											<th width="380">商品信息</th>
											<th width="85">单价</th>
											<th width="85">数量</th>
											<th width="120">实付款</th>
											<th width="120">交易状态</th>
											<th width="120">交易操作</th>
										</tr>
                                        <tbody id='eee'>
                                        <tr id="eeee"></tr>
                                        </tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				
				</div>
			</div>
		</section>
	</div>
	<!-- 右侧菜单 -->
	<div class="right-nav">
		<ul class="r-with-gotop">
			<li class="r-toolbar-item">
				<a href="udai_welcome.html" class="r-item-hd">
					<i class="iconfont icon-user" data-badge="0"></i>
					<div class="r-tip__box"><span class="r-tip-text">用户中心</span></div>
				</a>
			</li>
			<li class="r-toolbar-item">
				<a href="wphshopcart.html" class="r-item-hd">
					<i class="iconfont icon-cart"></i>
					<div class="r-tip__box"><span class="r-tip-text">购物车</span></div>
				</a>
			</li>
			<li class="r-toolbar-item">
				<a href="udai_collection.html" class="r-item-hd">
					<i class="iconfont icon-aixin"></i>
					<div class="r-tip__box"><span class="r-tip-text">我的收藏</span></div>
				</a>
			</li>
			<li class="r-toolbar-item">
				<a href="connectService.html" class="r-item-hd">
					<i class="iconfont icon-liaotian"></i>
					<div class="r-tip__box"><span class="r-tip-text">联系客服</span></div>
				</a>
			</li>
			<li class="r-toolbar-item">
				<a href="connectService.html" class="r-item-hd">
					<i class="iconfont icon-liuyan"></i>
					<div class="r-tip__box"><span class="r-tip-text">留言反馈</span></div>
				</a>
			</li>
			<li class="r-toolbar-item to-top">
				<i class="iconfont icon-top"></i>
				<div class="r-tip__box"><span class="r-tip-text">返回顶部</span></div>
			</li>
		</ul>
		<script>
			$(document).ready(function(){ $('.to-top').toTop({position:false}) });
		</script>
	</div>
	<!-- 底部信息 -->
	<div class="footer">
		<div class="footer-tags">
			<div class="tags-box inner">
				<div class="tag-div">
					<img src="images/icons/footer_1.gif" alt="厂家直供">
				</div>
				<div class="tag-div">
					<img src="images/icons/footer_2.gif" alt="一件代发">
				</div>
				<div class="tag-div">
					<img src="images/icons/footer_3.gif" alt="美工活动支持">
				</div>
				<div class="tag-div">
					<img src="images/icons/footer_4.gif" alt="信誉认证">
				</div>
			</div>
		</div>
		<div class="footer-links inner">
			<dl>
				<dt>U袋网</dt>
				<a href="temp_article/udai_article10.html"><dd>企业简介</dd></a>
				<a href="temp_article/udai_article11.html"><dd>加入U袋</dd></a>
				<a href="temp_article/udai_article12.html"><dd>隐私说明</dd></a>
			</dl>
			<dl>
				<dt>服务中心</dt>
				<a href="temp_article/udai_article1.html"><dd>售后服务</dd></a>
				<a href="temp_article/udai_article2.html"><dd>配送服务</dd></a>
				<a href="temp_article/udai_article3.html"><dd>用户协议</dd></a>
				<a href="temp_article/udai_article4.html"><dd>常见问题</dd></a>
			</dl>
			<dl>
				<dt>新手上路</dt>
				<a href="temp_article/udai_article5.html"><dd>如何成为代理商</dd></a>
				<a href="temp_article/udai_article6.html"><dd>代销商上架教程</dd></a>
				<a href="temp_article/udai_article7.html"><dd>分销商常见问题</dd></a>
				<a href="temp_article/udai_article8.html"><dd>付款账户</dd></a>
			</dl>
		</div>
		<div class="copy-box clearfix">
			<ul class="copy-links">
				<a href="agent_level.html"><li>网店代销</li></a>
				<a href="class_room.html"><li>U袋学堂</li></a>
				<a href="udai_about.html"><li>联系我们</li></a>
				<a href="temp_article/udai_article10.html"><li>企业简介</li></a>
				<a href="temp_article/udai_article5.html"><li>新手上路</li></a>
			</ul>
			<!-- 版权 -->
			<p class="copyright">
				© 2005-2017 U袋网 版权所有，并保留所有权利<br>
				ICP备案证书号：闽ICP备16015525号-2&nbsp;&nbsp;&nbsp;&nbsp;福建省宁德市福鼎市南下村小区（锦昌阁）1栋1梯602室&nbsp;&nbsp;&nbsp;&nbsp;Tel: 18650406668&nbsp;&nbsp;&nbsp;&nbsp;E-mail: 18650406668@qq.com
			</p>
		</div>
	</div>
</body>
<!--<script src="js/jquery.DJMask.2.1.1.js" charset="UTF-8"></script>-->
</html>